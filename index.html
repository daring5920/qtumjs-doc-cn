
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>QtumJS API Reference</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .cd {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .nl {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
  </head>

  <body class="index" data-languages="[&quot;typescript&quot;,&quot;javascript&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" alt="Navbar" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="images/logo.png" class="logo" alt="Logo" />
        <div class="lang-selector">
              <a href="#" data-language-name="typescript">typescript</a>
              <a href="#" data-language-name="javascript">javascript</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc" class="toc-list-h1">
          <li>
            <a href="#" class="toc-h1 toc-link" data-title="介绍">介绍</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#qtum-rpc" class="toc-h2 toc-link" data-title="运行 Qtum RPC">运行 Qtum RPC</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#erc20" class="toc-h1 toc-link" data-title="ERC20 实例">ERC20 实例</a>
          </li>
          <li>
            <a href="#qtum" class="toc-h1 toc-link" data-title="Qtum">Qtum</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#contract" class="toc-h2 toc-link" data-title="contract">contract</a>
                  </li>
                  <li>
                    <a href="#rawcall" class="toc-h2 toc-link" data-title="rawCall">rawCall</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#contract-2" class="toc-h1 toc-link" data-title="Contract">Contract</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#-2" class="toc-h2 toc-link" data-title="构造函数">构造函数</a>
                  </li>
                  <li>
                    <a href="#call" class="toc-h2 toc-link" data-title="call">call</a>
                  </li>
                  <li>
                    <a href="#send" class="toc-h2 toc-link" data-title="send">send</a>
                  </li>
                  <li>
                    <a href="#-3" class="toc-h2 toc-link" data-title="方法重载">方法重载</a>
                  </li>
                  <li>
                    <a href="#logs" class="toc-h2 toc-link" data-title="logs">logs</a>
                  </li>
                  <li>
                    <a href="#onlogs" class="toc-h2 toc-link" data-title="onLogs">onLogs</a>
                  </li>
                  <li>
                    <a href="#logemitter" class="toc-h2 toc-link" data-title="logEmitter">logEmitter</a>
                  </li>
                  <li>
                    <a href="#receipt" class="toc-h2 toc-link" data-title="receipt">receipt</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#qtumrpc" class="toc-h1 toc-link" data-title="QtumRPC">QtumRPC</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#rawcall-2" class="toc-h2 toc-link" data-title="rawCall">rawCall</a>
                  </li>
                  <li>
                    <a href="#all-rpc" class="toc-h2 toc-link" data-title="All RPC 方法">All RPC 方法</a>
                  </li>
                  <li>
                    <a href="#getblockcount" class="toc-h2 toc-link" data-title="实例: getblockcount">实例: getblockcount</a>
                  </li>
                  <li>
                    <a href="#getnewaddress" class="toc-h2 toc-link" data-title="实例: getnewaddress">实例: getnewaddress</a>
                  </li>
                  <li>
                    <a href="#fromhexaddress" class="toc-h2 toc-link" data-title="实例: fromhexaddress">实例: fromhexaddress</a>
                  </li>
                  <li>
                    <a href="#gettransactionreceipt" class="toc-h2 toc-link" data-title="实例: gettransactionreceipt">实例: gettransactionreceipt</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#-4" class="toc-h1 toc-link" data-title="类型词典">类型词典</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#icontractinfo" class="toc-h2 toc-link" data-title="IContractInfo">IContractInfo</a>
                  </li>
                  <li>
                    <a href="#icontractcallresult" class="toc-h2 toc-link" data-title="IContractCallResult">IContractCallResult</a>
                  </li>
                  <li>
                    <a href="#icontractsendrequestoptions" class="toc-h2 toc-link" data-title="IContractSendRequestOptions">IContractSendRequestOptions</a>
                  </li>
                  <li>
                    <a href="#icontractsendresult" class="toc-h2 toc-link" data-title="IContractSendResult">IContractSendResult</a>
                  </li>
                  <li>
                    <a href="#irpcgettransactionresult" class="toc-h2 toc-link" data-title="IRPCGetTransactionResult">IRPCGetTransactionResult</a>
                  </li>
                  <li>
                    <a href="#icontractsendreceipt" class="toc-h2 toc-link" data-title="IContractSendReceipt">IContractSendReceipt</a>
                  </li>
                  <li>
                    <a href="#irpcwaitforlogsrequest" class="toc-h2 toc-link" data-title="IRPCWaitForLogsRequest">IRPCWaitForLogsRequest</a>
                  </li>
                  <li>
                    <a href="#icontracteventlogs" class="toc-h2 toc-link" data-title="IContractEventLogs">IContractEventLogs</a>
                  </li>
                  <li>
                    <a href="#icontracteventlog" class="toc-h2 toc-link" data-title="IContractEventLog">IContractEventLog</a>
                  </li>
                  <li>
                    <a href="#idecodedsolidityevent" class="toc-h2 toc-link" data-title="IDecodedSolidityEvent">IDecodedSolidityEvent</a>
                  </li>
                  <li>
                    <a href="#irpcgettransactionreceiptbase" class="toc-h2 toc-link" data-title="IRPCGetTransactionReceiptBase">IRPCGetTransactionReceiptBase</a>
                  </li>
                  <li>
                    <a href="#icontractsrepodata" class="toc-h2 toc-link" data-title="IContractsRepoData">IContractsRepoData</a>
                  </li>
              </ul>
          </li>
      </div>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id=''>介绍</h1>
<blockquote>
<p>安装 qtumjs</p>
</blockquote>
<pre class="highlight plaintext"><code>npm install qtumjs
</code></pre>
<p>QtumJS是一个用于在Qtum区块链上开发DApp的JavaScript库。您可以使用此库来开发在浏览器中运行的前端UI以及在NodeJS中运行的后端脚本。</p>

<p>主要的类：
类 | 描述
--------- | -----------
QtumRPCRaw | 使用 JSONRPC 1.0调用合约，直接访问 <code>qtumd</code> 的区块链 RPC 服务。
QtumRPC | <code>QtumRPCRaw</code> 的封装，提供像 JSONRPC 2.0 这样的接口。
Contract | 与智能合约交互的抽象层。使用 <a href="https://github.com/ethereum/wiki/wiki/Ethereum-Contract-ABI">ABI encoding/decoding</a>.</p>

<p>QtumJS 使用 <a href="https://www.typescriptlang.org/">TypeScript</a> 开发, 因此为所有 API 提供了健壮的类型定义。 我们建议使用 <a href="https://code.visualstudio.com/">VSCode</a> 来获得语言支持，例如类型提示和自动完成。</p>

<p>当然，你愿意的话也可以选择使用普通的 JavaScript 和记事本。</p>

<p>本文档是 QtumJS API 及其基本用法的参考文档。有关 QtumJS 的教程式介绍，查看: <a href="https://github.com/qtumproject/qtumbook/blob/master/part2/erc20-js.md">QtumBook - ERC20 With QtumJS</a>.</p>
<h2 id='qtum-rpc'>运行 Qtum RPC</h2>
<blockquote>
<p>开发模式运行 qtumd：</p>
</blockquote>
<pre class="highlight plaintext"><code>docker run -it --rm \
  --name myapp \
  -v `pwd`:/dapp \
  -p 3889:3889 \
  hayeah/qtumportal
</code></pre>
<blockquote>
<p>测试网络（testnet）运行 qtumd：</p>
</blockquote>
<pre class="highlight plaintext"><code>docker run -it --rm \
  --name myapp \
  -e "QTUM_NETWORK=testnet" \
  -v `pwd`:/dapp \
  -p 3889:3889 \
  hayeah/qtumportal
</code></pre>
<p>QtumJS 依赖 <code>qtumd</code> 提供的访问 QTUM 区块链的 JSON-RPC 服务。</p>

<p>更多细节请查看: <a href="https://github.com/qtumproject/qtumbook/blob/master/SUMMARY.md#part-1---running-qtum">QtumBook - Running QTUM</a>.</p>

<aside class="notice">
默认 JSON-RPC 是 “qtum：test”，运行端口为 3889
</aside>
<h1 id='erc20'>ERC20 实例</h1><pre class="highlight typescript"><code><span class="k">import</span> <span class="p">{</span>
  <span class="nx">Qtum</span><span class="p">,</span>
<span class="p">}</span> <span class="k">from</span> <span class="s2">"qtumjs"</span>

<span class="kd">const</span> <span class="nx">repoData</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">"./solar.json"</span><span class="p">)</span>
<span class="kd">const</span> <span class="nx">qtum</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Qtum</span><span class="p">(</span><span class="s2">"http://qtum:test@localhost:3889"</span><span class="p">,</span> <span class="nx">repoData</span><span class="p">)</span>

<span class="kd">const</span> <span class="nx">myToken</span> <span class="o">=</span> <span class="nx">qtum</span><span class="p">.</span><span class="nx">contract</span><span class="p">(</span><span class="s2">"zeppelin-solidity/contracts/token/CappedToken.sol"</span><span class="p">)</span>

<span class="k">async</span> <span class="kd">function</span> <span class="nx">transfer</span><span class="p">(</span><span class="nx">fromAddr</span><span class="p">,</span> <span class="nx">toAddr</span><span class="p">,</span> <span class="nx">amount</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">tx</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">myToken</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="s2">"transfer"</span><span class="p">,</span> <span class="p">[</span><span class="nx">toAddr</span><span class="p">,</span> <span class="nx">amount</span><span class="p">],</span> <span class="p">{</span>
    <span class="na">senderAddress</span><span class="p">:</span> <span class="nx">fromAddr</span><span class="p">,</span>
  <span class="p">})</span>

  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"transfer tx:"</span><span class="p">,</span> <span class="nx">tx</span><span class="p">.</span><span class="nx">txid</span><span class="p">)</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">tx</span><span class="p">)</span>

  <span class="k">await</span> <span class="nx">tx</span><span class="p">.</span><span class="nx">confirm</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"transfer confirmed"</span><span class="p">)</span>
<span class="p">}</span>
</code></pre>
<p>假设 <code>solar.json</code> 包含已部署的合约，则可以使用 qtumjs 调用代币合约的方法来流通代币。</p>

<p>一个实例 <a href="https://github.com/qtumproject/qtumbook-mytoken-qtumjs-cli/blob/29fab6dfcca55013c7efa8ee5e91bbc8c40ca55a/solar.development.json.example">solar.json</a>. 这个可以使用 <a href="https://github.com/qtumproject/solar">solar</a> 部署工具自动生成。</p>

<p>完整实例: <a href="https://github.com/qtumproject/qtumbook-mytoken-qtumjs-cli">qtumproject/qtumbook-mytoken-qtumjs-cli</a></p>

<p>合约开发, 查看 <a href="https://github.com/qtumproject/solar">Solar Smart Contract Deployment Tool</a>.</p>

<p>为了充实教程, 查看 <a href="https://github.com/qtumproject/qtumbook/blob/master/part2/erc20-js.md">QtumBook - ERC20 With QtumJS</a>.</p>
<h1 id='qtum'>Qtum</h1><pre class="highlight typescript"><code><span class="kd">const</span> <span class="nx">repoData</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">"./solar.json"</span><span class="p">)</span>
<span class="kd">const</span> <span class="nx">qtum</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Qtum</span><span class="p">(</span><span class="s2">"http://qtum:test@localhost:3889"</span><span class="p">,</span> <span class="nx">repoData</span><span class="p">)</span>
</code></pre>
<p><code>Qtum</code> 是 <code>qtumjs</code> API 的一个对象. 它提供两个主要功能：</p>

<ul>
<li>对 <code>qtumd</code> RPC 服务的访问. 它是 <a href="#qtumrpc">QtumRPC</a> 的子类.</li>
<li>实例化 <a href="#contract-2">Contract</a> 对象的工厂方法, 用于与已部署的合约进行交互。</li>
</ul>

<table><thead>
<tr>
<th>参数</th>
<th>类型</th>
</tr>
</thead><tbody>
<tr>
<td>url</td>
<td>string</td>
</tr>
<tr>
<td></td>
<td>qtumd RPC 服务的 URL</td>
</tr>
<tr>
<td>repoData</td>
<td><a href="#icontractsrepodata">IContractsRepoData</a></td>
</tr>
<tr>
<td></td>
<td>关于 Solidity 合约的信息.</td>
</tr>
</tbody></table>

<p><code>repoData</code> 包含所有已部署合约或库的 ABI 定义，以及它们的部署地址。这些信息用于实例化 <code>Contract</code> 实例。</p>

<p>使用 <code>Qtum</code> 的工厂方法实例化的 <code>Contract</code> 对象能够解码所有在 <code>repoData</code> 里的事件类型. 但是手动构建的合约只能解码在其范围内定义的事件类型, 这也是 Solidity 编译器输出 ABI 定义的限制。</p>

<p>建议使用 Qtum 来实例化 <code>Contract</code> 对象.</p>
<h2 id='contract'>contract</h2><pre class="highlight typescript"><code><span class="kd">const</span> <span class="nx">myToken</span> <span class="o">=</span> <span class="nx">qtum</span><span class="p">.</span><span class="nx">contract</span><span class="p">(</span><span class="s2">"zeppelin-solidity/contracts/token/CappedToken.sol"</span><span class="p">)</span>
</code></pre>
<blockquote>
<p>实例化这个合约使用了 <a href="https://github.com/qtumproject/qtumbook-mytoken-qtumjs-cli/blob/29fab6dfcca55013c7efa8ee5e91bbc8c40ca55a/solar.development.json.example#L3">这些</a> 信息。</p>
</blockquote>

<p>实例化 <code>Contract</code> 对象的工厂方法，使用了 <code>repoData</code> 中的 ABI 定义和地址。合约对象是使用一个事件 log 解码器来配置的，这个解码器能解码所有 <code>repoData</code> 中已知的事件类型。</p>

<table><thead>
<tr>
<th>参数</th>
<th>类型</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td>string</td>
</tr>
<tr>
<td></td>
<td>作为 <code>repoData.contracts</code> map 的 key，用于获取合约信息。</td>
</tr>
</tbody></table>
<h2 id='rawcall'>rawCall</h2>
<p>继承自 <a href="#rawcall-2">QtumRPC#rawcall</a></p>
<h1 id='contract-2'>Contract</h1>
<p>与智能合约交互的抽象层。</p>

<p>这比使用 <code>QtumRPC</code> 直接调用 RPC 的 <code>sendcontract</code> 和 <code>calltocontract</code> 方法更方便。它处理 ABI 编码，转换 JS 和 Solidity 值。</p>

<ul>
<li>有 API 用于确认交易。</li>
<li>有 API 用于调用合约方法，使用 <code>call</code> 或 <code>send</code> .</li>
<li>有 API 用于获取合约 log 事件。</li>
</ul>
<h2 id='-2'>构造函数</h2><pre class="highlight javascript"><code><span class="kr">const</span> <span class="nx">rpc</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">QtumRPC</span><span class="p">(</span><span class="s2">"http://qtum:test@localhost:3889"</span><span class="p">)</span>

<span class="kr">const</span> <span class="nx">myToken</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Contract</span><span class="p">(</span><span class="nx">rpc</span><span class="p">,</span> <span class="nx">repo</span><span class="p">.</span><span class="nx">contracts</span><span class="p">[</span>
  <span class="s2">"zeppelin-solidity/contracts/token/CappedToken.sol"</span>
<span class="p">])</span>
</code></pre>
<blockquote>
<p>合约 <a href="https://github.com/qtumproject/qtumbook-mytoken-qtumjs-cli/blob/29fab6dfcca55013c7efa8ee5e91bbc8c40ca55a/solar.development.json.example#L3">信息</a> 可以使用 <a href="https://github.com/qtumproject/solar">solar</a>. 生成</p>
</blockquote>

<table><thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead><tbody>
<tr>
<td>rpc</td>
<td>QtumRPC</td>
<td>RPC 对象，用于与合约进行交互</td>
</tr>
<tr>
<td>info</td>
<td><a href="#icontractinfo">IContractInfo</a></td>
<td>信息，用于部署合约</td>
</tr>
</tbody></table>

<p>建议使用 <a href="#contract">Qtum#contract</a> 而不是这个构造器。</p>
<h2 id='call'>call</h2><pre class="highlight javascript"><code><span class="nx">async</span> <span class="kd">function</span> <span class="nx">totalSupply</span><span class="p">()</span> <span class="p">{</span>
  <span class="kr">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">await</span> <span class="nx">myToken</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="s2">"totalSupply"</span><span class="p">)</span>

  <span class="c1">// supply is a BigNumber instance (see: bn.js)</span>
  <span class="kr">const</span> <span class="nx">supply</span> <span class="o">=</span> <span class="nx">result</span><span class="p">.</span><span class="nx">outputs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"supply"</span><span class="p">,</span> <span class="nx">supply</span><span class="p">.</span><span class="nx">toNumber</span><span class="p">())</span>
<span class="p">}</span>
</code></pre>
<blockquote>
<p>实例输出:</p>
</blockquote>
<pre class="highlight javascript"><code><span class="p">{</span> <span class="nl">address</span><span class="p">:</span> <span class="s1">'a778c05f1d0f70f1133f4bbf78c1a9a7bf84aed3'</span><span class="p">,</span>
  <span class="nx">executionResult</span><span class="p">:</span>
   <span class="p">{</span> <span class="nl">gasUsed</span><span class="p">:</span> <span class="mi">21689</span><span class="p">,</span>
     <span class="nx">excepted</span><span class="p">:</span> <span class="s1">'None'</span><span class="p">,</span>
     <span class="nx">newAddress</span><span class="p">:</span> <span class="s1">'a778c05f1d0f70f1133f4bbf78c1a9a7bf84aed3'</span><span class="p">,</span>
     <span class="nx">output</span><span class="p">:</span> <span class="s1">'00000000000000000000000000000000000000000000000000000000000036b0'</span><span class="p">,</span>
     <span class="nx">codeDeposit</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
     <span class="nx">gasRefunded</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
     <span class="nx">depositSize</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
     <span class="nx">gasForDeposit</span><span class="p">:</span> <span class="mi">0</span> <span class="p">},</span>
  <span class="nx">transactionReceipt</span><span class="p">:</span>
   <span class="p">{</span> <span class="nl">stateRoot</span><span class="p">:</span> <span class="s1">'5a0d9cd5df18165c75755f4345ca81da94f9247c1c031171fd6e2ce1a368844c'</span><span class="p">,</span>
     <span class="nx">gasUsed</span><span class="p">:</span> <span class="mi">21689</span><span class="p">,</span>
     <span class="nx">bloom</span><span class="p">:</span> <span class="s1">'0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000'</span><span class="p">,</span>
     <span class="nx">log</span><span class="p">:</span> <span class="p">[]</span> <span class="p">},</span>
  <span class="nx">outputs</span><span class="p">:</span> <span class="p">[</span> <span class="o">&lt;</span><span class="nx">BN</span><span class="p">:</span> <span class="mi">36</span><span class="nx">b0</span><span class="o">&gt;</span> <span class="p">]</span> <span class="p">}</span>
</code></pre>
<blockquote>
<p>模拟 &quot;mint&quot; 调用:</p>
</blockquote>
<pre class="highlight typescript"><code><span class="kd">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">myToken</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="s2">"mint"</span><span class="p">,</span> <span class="p">[</span><span class="s2">"dcd32b87270aeb980333213da2549c9907e09e94"</span><span class="p">,</span> <span class="mi">1000</span><span class="p">])</span>
</code></pre>
<blockquote>
<p>运行结果:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"address"</span><span class="p">:</span><span class="w"> </span><span class="s2">"a778c05f1d0f70f1133f4bbf78c1a9a7bf84aed3"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"executionResult"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"gasUsed"</span><span class="p">:</span><span class="w"> </span><span class="mi">39306</span><span class="p">,</span><span class="w">
    </span><span class="s2">"excepted"</span><span class="p">:</span><span class="w"> </span><span class="s2">"None"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"newAddress"</span><span class="p">:</span><span class="w"> </span><span class="s2">"a778c05f1d0f70f1133f4bbf78c1a9a7bf84aed3"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"output"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0000000000000000000000000000000000000000000000000000000000000001"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"codeDeposit"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="s2">"gasRefunded"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="s2">"depositSize"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="s2">"gasForDeposit"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"transactionReceipt"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"stateRoot"</span><span class="p">:</span><span class="w"> </span><span class="s2">"9922edb770bd700a212427d3bc0764a9fed953a987952b2619b8a78dac7498aa"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"gasUsed"</span><span class="p">:</span><span class="w"> </span><span class="mi">39306</span><span class="p">,</span><span class="w">
    </span><span class="s2">"bloom"</span><span class="p">:</span><span class="w"> </span><span class="s2">"00000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000020000000000008000000000000000000000000000000000000000000000000020000000020000000000800000000000000400000000010000000000000000000000000000000000000000000000000000000000000000000000000000080000000080000000000000000000000000000000000000000000000000000000002010000000000000000000000000000000200000000000000000020000000000000000000000000000000000000000000000000020000000000000000"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"log"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="s2">"address"</span><span class="p">:</span><span class="w"> </span><span class="s2">"a778c05f1d0f70f1133f4bbf78c1a9a7bf84aed3"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"topics"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="s2">"0f6798a560793a54c3bcfe86a93cde1e73087d944c0ea20544137d4121396885"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"000000000000000000000000dcd32b87270aeb980333213da2549c9907e09e94"</span><span class="w">
        </span><span class="p">],</span><span class="w">
        </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="s2">"00000000000000000000000000000000000000000000000000000000000003e8"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="s2">"address"</span><span class="p">:</span><span class="w"> </span><span class="s2">"a778c05f1d0f70f1133f4bbf78c1a9a7bf84aed3"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"topics"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="s2">"ddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"0000000000000000000000000000000000000000000000000000000000000000"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"000000000000000000000000dcd32b87270aeb980333213da2549c9907e09e94"</span><span class="w">
        </span><span class="p">],</span><span class="w">
        </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="s2">"00000000000000000000000000000000000000000000000000000000000003e8"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"outputs"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="kc">true</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="s2">"logs"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Mint"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"to"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dcd32b87270aeb980333213da2549c9907e09e94"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"amount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3e8"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Transfer"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"from"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0000000000000000000000000000000000000000"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"to"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dcd32b87270aeb980333213da2549c9907e09e94"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3e8"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>使用 <code>callcontract</code> 在你本地 qtumd 节点 “模拟” 执行合约方法。这是免费的，实际上并不修改区块链。</p>

<p>这个免费。</p>

<table><thead>
<tr>
<th>参数</th>
<th>类型</th>
</tr>
</thead><tbody>
<tr>
<td>method</td>
<td>string</td>
</tr>
<tr>
<td></td>
<td>合约方法名</td>
</tr>
<tr>
<td>args</td>
<td>Array&lt;any&gt;</td>
</tr>
<tr>
<td></td>
<td>调用方法的参数</td>
</tr>
<tr>
<td>opts</td>
<td>IContractCallRequestOptions</td>
</tr>
<tr>
<td></td>
<td>调用配置项</td>
</tr>
<tr>
<td>@return</td>
<td>Promise&lt;<a href="#icontractcallresult">IContractCallResult</a>&gt;</td>
</tr>
<tr>
<td></td>
<td>调用结果，带有 ABI 解码的输出</td>
</tr>
</tbody></table>
<h2 id='send'>send</h2><pre class="highlight typescript"><code><span class="k">async</span> <span class="kd">function</span> <span class="nx">mint</span><span class="p">(</span><span class="nx">toAddr</span><span class="p">,</span> <span class="nx">amount</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// Submit a `sendtocontract` transaction, invoking the `mint` method.</span>
  <span class="kd">const</span> <span class="nx">tx</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">myToken</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="s2">"mint"</span><span class="p">,</span> <span class="p">[</span><span class="nx">toAddr</span><span class="p">,</span> <span class="nx">amount</span><span class="p">])</span>

  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"tx:"</span><span class="p">,</span> <span class="nx">tx</span><span class="p">)</span>

  <span class="c1">// Wait for 3 confirmations. The callback receives the</span>
  <span class="c1">// updated transaction info for each additional confirmation.</span>
  <span class="c1">//</span>
  <span class="c1">// Both arguments are optional. `await tx.confirm()` would do.</span>
  <span class="kd">const</span> <span class="nx">receipt</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">tx</span><span class="p">.</span><span class="nx">confirm</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="p">(</span><span class="nx">updatedTx</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"new confirmation"</span><span class="p">,</span> <span class="nx">updatedTx</span><span class="p">.</span><span class="nx">txid</span><span class="p">,</span> <span class="nx">updatedTx</span><span class="p">.</span><span class="nx">confirmations</span><span class="p">)</span>
  <span class="p">})</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"tx receipt:"</span><span class="p">,</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">receipt</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="p">}</span>
</code></pre>
<blockquote>
<p>实例输出:</p>
</blockquote>
<pre class="highlight plaintext"><code>mint tx: 858347704258506012f538b19b9702d636dc350bc25a7e60d404bf3d2c08efd9
{ amount: 0,
  fee: -0.081064,
  confirmations: 0,
  trusted: true,
  txid: '858347704258506012f538b19b9702d636dc350bc25a7e60d404bf3d2c08efd9',
  walletconflicts: [],
  time: 1515475961,
  timereceived: 1515475961,
  'bip125-replaceable': 'no',
  details:
   [ { account: '',
       category: 'send',
       amount: 0,
       vout: 0,
       fee: -0.081064,
       abandoned: false } ],
  hex: '0200000001006a977de70014fdc2546ed19a531326086c6c9631cb1c5352db5f09e147736b0100000049483045022100b4ca32770a9f42679c6d20b7ddb5feb160303fceafc2db0fedba18a22f0b643602203c2568eb689fd324e76a12f367552fe4cce36b29f8174738209f881959aadbab01feffffff02000000000000000063010403400d0301284440c10f19000000000000000000000000dcd32b87270aeb980333213da2549c9907e09e94000000
00000000000000000000000000000000000000000000000000000003e814a778c05f1d0f70f1133f4bbf78c1a9a7bf84aed3c2601e72902e0000001976a914dcd32b87270aeb980333213da2549c9907e09e9488ac212e0000',
  method: 'mint',
  confirm: [Function: confirm] }
</code></pre>
<blockquote>
<p>回调打印 3 次，分别对应每次确认</p>
</blockquote>
<pre class="highlight plaintext"><code>new confirmation 858347704258506012f538b19b9702d636dc350bc25a7e60d404bf3d2c08efd9 1
new confirmation 858347704258506012f538b19b9702d636dc350bc25a7e60d404bf3d2c08efd9 2
new confirmation 858347704258506012f538b19b9702d636dc350bc25a7e60d404bf3d2c08efd9 3
</code></pre>
<blockquote>
<p>确认后返回的交易收据：</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="w">
</span><span class="p">{</span><span class="w">
  </span><span class="s2">"blockHash"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3b53ad132c26f9c30e5be9f664573428dad8b52e167becea4428d6903cb32740"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"blockNumber"</span><span class="p">:</span><span class="w"> </span><span class="mi">13917</span><span class="p">,</span><span class="w">
  </span><span class="s2">"transactionHash"</span><span class="p">:</span><span class="w"> </span><span class="s2">"79338589bb75e1865be889142890a4e25d3b9dbd454ce3f3c2614587c85e2ed3"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"transactionIndex"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="s2">"from"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dcd32b87270aeb980333213da2549c9907e09e94"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"to"</span><span class="p">:</span><span class="w"> </span><span class="s2">"a778c05f1d0f70f1133f4bbf78c1a9a7bf84aed3"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"cumulativeGasUsed"</span><span class="p">:</span><span class="w"> </span><span class="mi">39306</span><span class="p">,</span><span class="w">
  </span><span class="s2">"gasUsed"</span><span class="p">:</span><span class="w"> </span><span class="mi">39306</span><span class="p">,</span><span class="w">
  </span><span class="s2">"contractAddress"</span><span class="p">:</span><span class="w"> </span><span class="s2">"a778c05f1d0f70f1133f4bbf78c1a9a7bf84aed3"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"logs"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Mint"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"to"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dcd32b87270aeb980333213da2549c9907e09e94"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"amount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"7d0"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Transfer"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"from"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0000000000000000000000000000000000000000"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"to"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dcd32b87270aeb980333213da2549c9907e09e94"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"7d0"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="s2">"rawlogs"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"address"</span><span class="p">:</span><span class="w"> </span><span class="s2">"a778c05f1d0f70f1133f4bbf78c1a9a7bf84aed3"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"topics"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"0f6798a560793a54c3bcfe86a93cde1e73087d944c0ea20544137d4121396885"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"000000000000000000000000dcd32b87270aeb980333213da2549c9907e09e94"</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="s2">"00000000000000000000000000000000000000000000000000000000000007d0"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"address"</span><span class="p">:</span><span class="w"> </span><span class="s2">"a778c05f1d0f70f1133f4bbf78c1a9a7bf84aed3"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"topics"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"ddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"0000000000000000000000000000000000000000000000000000000000000000"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"000000000000000000000000dcd32b87270aeb980333213da2549c9907e09e94"</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="s2">"00000000000000000000000000000000000000000000000000000000000007d0"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>创建一个交易，在网络全局执行合约方法，会改变区块链。</p>

<p>这要花费 gas.</p>

<p>对一个合约有 2 个异步步骤</p>

<ol>
<li>你提交交易到网络</li>
<li>一旦提交，等待一个指定的确认数</li>
</ol>

<p>成功确认后，返回带有ABI解码的事件日志的交易收据 (<a href="#icontractsendreceipt">IContractSendReceipt</a>)</p>

<table><thead>
<tr>
<th>参数</th>
<th>类型</th>
</tr>
</thead><tbody>
<tr>
<td>method</td>
<td>string</td>
</tr>
<tr>
<td></td>
<td>合约方法名</td>
</tr>
<tr>
<td>args</td>
<td>Array&lt;any&gt;</td>
</tr>
<tr>
<td></td>
<td>所调用方法的参数</td>
</tr>
<tr>
<td>opts</td>
<td><a href="#icontractsendrequestoptions">IContractSendRequestOptions</a></td>
</tr>
<tr>
<td></td>
<td><em>可选</em> 发送配置项</td>
</tr>
<tr>
<td>@return</td>
<td>Promise&lt;<a href="#icontractsendresult">IContractSendResult</a>&gt;</td>
</tr>
<tr>
<td></td>
<td>调用结果, 带有 ABI 解码的输出</td>
</tr>
</tbody></table>
<h2 id='-3'>方法重载</h2>
<p>如果没有歧义，使用方法名称来调用/发送方法。 如果相同方法名称具有多个定义，请使用方法签名来调用/发送方法。</p>

<blockquote>
<p>方法名 foo 可能有多个定义:</p>
</blockquote>
<pre class="highlight typescript"><code><span class="kd">function</span> <span class="nx">foo</span><span class="p">();</span>
<span class="kd">function</span> <span class="nx">foo</span><span class="p">(</span><span class="nx">int256</span> <span class="nx">_a</span><span class="p">);</span>
<span class="kd">function</span> <span class="nx">foo</span><span class="p">(</span><span class="nx">uint256</span> <span class="nx">_a</span><span class="p">,</span> <span class="nx">uint256</span> <span class="nx">_b</span><span class="p">);</span>
<span class="kd">function</span> <span class="nx">foo</span><span class="p">(</span><span class="nx">int256</span> <span class="nx">_a</span><span class="p">,</span> <span class="nx">int256</span> <span class="nx">_b</span><span class="p">);</span>
</code></pre>
<blockquote>
<p><code>foo</code> 方法有 0 个参数和有 1 个参数没有歧义。可以直接调用。</p>
</blockquote>
<pre class="highlight typescript"><code><span class="nx">contract</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="s2">"foo"</span><span class="p">)</span>
<span class="nx">contract</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="s2">"foo"</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</code></pre>
<blockquote>
<p><code>foo</code> 方法带 2 个参数的有歧义，必须带完整方法签名：</p>
</blockquote>
<pre class="highlight typescript"><code><span class="nx">contract</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="s2">"foo(uint256,uint256)"</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="nx">contract</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="s2">"foo(int256,int256)"</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
</code></pre><h2 id='logs'>logs</h2><pre class="highlight javascript"><code><span class="nx">async</span> <span class="kd">function</span> <span class="nx">getLogs</span><span class="p">(</span><span class="nx">fromBlock</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nx">toBlock</span><span class="o">=</span><span class="s2">"latest"</span><span class="p">)</span> <span class="p">{</span>
  <span class="kr">const</span> <span class="nx">logs</span> <span class="o">=</span> <span class="nx">await</span> <span class="nx">myToken</span><span class="p">.</span><span class="nx">logs</span><span class="p">({</span>
    <span class="nx">fromBlock</span><span class="p">,</span>
    <span class="nx">toBlock</span><span class="p">,</span>
    <span class="na">minconf</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
  <span class="p">})</span>

  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">logs</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="p">}</span>
</code></pre>
<blockquote>
<p>实例输出</p>
</blockquote>
<pre class="highlight javascript"><code><span class="p">{</span>
  <span class="s2">"entries"</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">"blockHash"</span><span class="p">:</span> <span class="s2">"369c6ded05c27ae7efc97964cce083b0ea9b8b950e67c51e52cb1bf898b9c415"</span><span class="p">,</span>
      <span class="s2">"blockNumber"</span><span class="p">:</span> <span class="mi">12184</span><span class="p">,</span>
      <span class="s2">"transactionHash"</span><span class="p">:</span> <span class="s2">"d1638a53f38fd68c5763e2eef9d86b9fc6ee7ea3f018dae7b1e385b4a9a78bc7"</span><span class="p">,</span>
      <span class="s2">"transactionIndex"</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
      <span class="s2">"from"</span><span class="p">:</span> <span class="s2">"dcd32b87270aeb980333213da2549c9907e09e94"</span><span class="p">,</span>
      <span class="s2">"to"</span><span class="p">:</span> <span class="s2">"a778c05f1d0f70f1133f4bbf78c1a9a7bf84aed3"</span><span class="p">,</span>
      <span class="s2">"cumulativeGasUsed"</span><span class="p">:</span> <span class="mi">39306</span><span class="p">,</span>
      <span class="s2">"gasUsed"</span><span class="p">:</span> <span class="mi">39306</span><span class="p">,</span>
      <span class="s2">"contractAddress"</span><span class="p">:</span> <span class="s2">"a778c05f1d0f70f1133f4bbf78c1a9a7bf84aed3"</span><span class="p">,</span>
      <span class="s2">"topics"</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">"0f6798a560793a54c3bcfe86a93cde1e73087d944c0ea20544137d4121396885"</span><span class="p">,</span>
        <span class="s2">"000000000000000000000000dcd32b87270aeb980333213da2549c9907e09e94"</span>
      <span class="p">],</span>
      <span class="s2">"data"</span><span class="p">:</span> <span class="s2">"00000000000000000000000000000000000000000000000000000000000003e8"</span><span class="p">,</span>
      <span class="s2">"event"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"Mint"</span><span class="p">,</span>
        <span class="s2">"to"</span><span class="p">:</span> <span class="s2">"dcd32b87270aeb980333213da2549c9907e09e94"</span><span class="p">,</span>
        <span class="s2">"amount"</span><span class="p">:</span> <span class="s2">"3e8"</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s2">"blockHash"</span><span class="p">:</span> <span class="s2">"369c6ded05c27ae7efc97964cce083b0ea9b8b950e67c51e52cb1bf898b9c415"</span><span class="p">,</span>
      <span class="s2">"blockNumber"</span><span class="p">:</span> <span class="mi">12184</span><span class="p">,</span>
      <span class="s2">"transactionHash"</span><span class="p">:</span> <span class="s2">"d1638a53f38fd68c5763e2eef9d86b9fc6ee7ea3f018dae7b1e385b4a9a78bc7"</span><span class="p">,</span>
      <span class="s2">"transactionIndex"</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
      <span class="s2">"from"</span><span class="p">:</span> <span class="s2">"dcd32b87270aeb980333213da2549c9907e09e94"</span><span class="p">,</span>
      <span class="s2">"to"</span><span class="p">:</span> <span class="s2">"a778c05f1d0f70f1133f4bbf78c1a9a7bf84aed3"</span><span class="p">,</span>
      <span class="s2">"cumulativeGasUsed"</span><span class="p">:</span> <span class="mi">39306</span><span class="p">,</span>
      <span class="s2">"gasUsed"</span><span class="p">:</span> <span class="mi">39306</span><span class="p">,</span>
      <span class="s2">"contractAddress"</span><span class="p">:</span> <span class="s2">"a778c05f1d0f70f1133f4bbf78c1a9a7bf84aed3"</span><span class="p">,</span>
      <span class="s2">"topics"</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">"ddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"</span><span class="p">,</span>
        <span class="s2">"0000000000000000000000000000000000000000000000000000000000000000"</span><span class="p">,</span>
        <span class="s2">"000000000000000000000000dcd32b87270aeb980333213da2549c9907e09e94"</span>
      <span class="p">],</span>
      <span class="s2">"data"</span><span class="p">:</span> <span class="s2">"00000000000000000000000000000000000000000000000000000000000003e8"</span><span class="p">,</span>
      <span class="s2">"event"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"Transfer"</span><span class="p">,</span>
        <span class="s2">"from"</span><span class="p">:</span> <span class="s2">"0000000000000000000000000000000000000000"</span><span class="p">,</span>
        <span class="s2">"to"</span><span class="p">:</span> <span class="s2">"dcd32b87270aeb980333213da2549c9907e09e94"</span><span class="p">,</span>
        <span class="s2">"value"</span><span class="p">:</span> <span class="s2">"3e8"</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">],</span>
  <span class="s2">"count"</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
  <span class="s2">"nextblock"</span><span class="p">:</span> <span class="mi">12185</span>
<span class="p">}</span>
</code></pre>
<p>获取由合约生成的 <a href="http://solidity.readthedocs.io/en/develop/abi-spec.html#events">Solidity 事件日志</a> 。</p>

<p>通过指定 <code>fromBlock</code> 和 <code>toBlock</code>，可以将事件日志查询限制块号范围。 例如，可以查询块 1000 到 1500 之间的事件日志。</p>

<p>此外，你可以使用 <code>minconf</code> 指定事件日志之前确认的最小数量作为结果返回。</p>

<table><thead>
<tr>
<th>参数</th>
<th>类型</th>
</tr>
</thead><tbody>
<tr>
<td>opts</td>
<td><a href="#irpcwaitforlogsrequest">IRPCWaitForLogsRequest</a></td>
</tr>
<tr>
<td></td>
<td>事件日志查询参数</td>
</tr>
<tr>
<td>@return</td>
<td>Promise&lt;<a href="#icontracteventlogs">IContractEventLogs</a>&gt;</td>
</tr>
<tr>
<td></td>
<td>日志查询结果，带有 ABI 解码的输出</td>
</tr>
</tbody></table>
<h2 id='onlogs'>onLogs</h2><pre class="highlight javascript"><code><span class="nx">myToken</span><span class="p">.</span><span class="nx">onLog</span><span class="p">((</span><span class="nx">entry</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">entry</span><span class="p">)</span>
<span class="p">},</span> <span class="p">{</span> <span class="na">minconf</span><span class="p">:</span> <span class="mi">1</span> <span class="p">})</span>
</code></pre>
<p>订阅合约新事件。每次收到新事件时都会调用回调。默认情况下，<code>onLog</code> 监听来自区块链顶端的日志。 使用 <code>fromBlock</code> 也可以接收较早的事件。</p>

<table><thead>
<tr>
<th>参数</th>
<th>类型</th>
</tr>
</thead><tbody>
<tr>
<td>callback</td>
<td>(entry: <a href="#icontracteventlog">IContractEventLog</a>) =&gt; void</td>
</tr>
<tr>
<td>opts</td>
<td><a href="#irpcwaitforlogsrequest">IRPCWaitForLogsRequest</a></td>
</tr>
<tr>
<td></td>
<td>事件日志查询参数</td>
</tr>
</tbody></table>
<h2 id='logemitter'>logEmitter</h2><pre class="highlight javascript"><code><span class="k">this</span><span class="p">.</span><span class="nx">emitter</span> <span class="o">=</span> <span class="nx">myToken</span><span class="p">.</span><span class="nx">logEmitter</span><span class="p">({</span> <span class="na">minconf</span><span class="p">:</span> <span class="mi">1</span> <span class="p">})</span>

<span class="k">this</span><span class="p">.</span><span class="nx">emitter</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">"Mint"</span><span class="p">,</span> <span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="c1">// ...</span>
<span class="p">})</span>

<span class="k">this</span><span class="p">.</span><span class="nx">emitter</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">"Transfer"</span><span class="p">,</span> <span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="c1">// ...</span>
<span class="p">})</span>

<span class="k">this</span><span class="p">.</span><span class="nx">emitter</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">"?"</span><span class="p">,</span> <span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="c1">// all un-decodeable events</span>
<span class="p">})</span>
</code></pre>
<p>使用 <a href="https://github.com/primus/eventemitter3">EventsEmitter</a> 接口订阅合约新事件。发出的事件是 <a href="#icontracteventlog">IContractEventLog</a> 对象。</p>

<p>Solidity 事件名作为发出的事件名使用。</p>

<p>缺失 ABI 定义的事件 (即不能解析) 会发送 &quot;?&quot;.</p>

<table><thead>
<tr>
<th>参数</th>
<th>类型</th>
</tr>
</thead><tbody>
<tr>
<td>opts</td>
<td><a href="#irpcwaitforlogsrequest">IRPCWaitForLogsRequest</a></td>
</tr>
<tr>
<td></td>
<td>事件日志查询参数</td>
</tr>
</tbody></table>
<h2 id='receipt'>receipt</h2><pre class="highlight typescript"><code><span class="kd">const</span> <span class="nx">txid</span> <span class="o">=</span> <span class="s2">"62fecfd27d71ddb260ac48c73c8f0f87e96d0b3a598ed2c2251caa4e6f9a9d97"</span>
<span class="kd">const</span> <span class="nx">receipt</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">qrcToken</span><span class="p">.</span><span class="nx">receipt</span><span class="p">(</span><span class="nx">txid</span><span class="p">)</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">receipt</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</code></pre>
<blockquote>
<p>实例输出</p>
</blockquote>
<pre class="highlight javascript"><code><span class="p">{</span>
  <span class="s2">"blockHash"</span><span class="p">:</span> <span class="s2">"af37cb8d9905521542243005fadc9f18c1498c9823e35fa277ea1c37174c289a"</span><span class="p">,</span>
  <span class="s2">"blockNumber"</span><span class="p">:</span> <span class="mi">83981</span><span class="p">,</span>
  <span class="s2">"transactionHash"</span><span class="p">:</span> <span class="s2">"62fecfd27d71ddb260ac48c73c8f0f87e96d0b3a598ed2c2251caa4e6f9a9d97"</span><span class="p">,</span>
  <span class="s2">"transactionIndex"</span><span class="p">:</span> <span class="mi">28</span><span class="p">,</span>
  <span class="s2">"from"</span><span class="p">:</span> <span class="s2">"57142e3bcf000f28890b5d979afc7ea90204e1de"</span><span class="p">,</span>
  <span class="s2">"to"</span><span class="p">:</span> <span class="s2">"49665919e437a4bedb92faa45ed33ebb5a33ee63"</span><span class="p">,</span>
  <span class="s2">"cumulativeGasUsed"</span><span class="p">:</span> <span class="mi">37029</span><span class="p">,</span>
  <span class="s2">"gasUsed"</span><span class="p">:</span> <span class="mi">37029</span><span class="p">,</span>
  <span class="s2">"contractAddress"</span><span class="p">:</span> <span class="s2">"49665919e437a4bedb92faa45ed33ebb5a33ee63"</span><span class="p">,</span>
  <span class="s2">"logs"</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"Transfer"</span><span class="p">,</span>
      <span class="s2">"from"</span><span class="p">:</span> <span class="s2">"57142e3bcf000f28890b5d979afc7ea90204e1de"</span><span class="p">,</span>
      <span class="s2">"to"</span><span class="p">:</span> <span class="s2">"c0ed80283c53c300c31c2bda6eca841e53cb6a21"</span><span class="p">,</span>
      <span class="s2">"value"</span><span class="p">:</span> <span class="s2">"1ba5add5700"</span>
    <span class="p">}</span>
  <span class="p">],</span>
  <span class="s2">"rawlogs"</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">"address"</span><span class="p">:</span> <span class="s2">"49665919e437a4bedb92faa45ed33ebb5a33ee63"</span><span class="p">,</span>
      <span class="s2">"topics"</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">"ddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"</span><span class="p">,</span>
        <span class="s2">"00000000000000000000000057142e3bcf000f28890b5d979afc7ea90204e1de"</span><span class="p">,</span>
        <span class="s2">"000000000000000000000000c0ed80283c53c300c31c2bda6eca841e53cb6a21"</span>
      <span class="p">],</span>
      <span class="s2">"data"</span><span class="p">:</span> <span class="s2">"000000000000000000000000000000000000000000000000000001ba5add5700"</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</code></pre>
<p>获取已被网络接受的交易收据。 如果交易尚未确认，则返回空值。</p>

<p>交易事件日志是 ABI 编码</p>

<table><thead>
<tr>
<th>参数</th>
<th>类型</th>
</tr>
</thead><tbody>
<tr>
<td>txid</td>
<td>string</td>
</tr>
<tr>
<td></td>
<td>交易 ID</td>
</tr>
<tr>
<td>@return</td>
<td>Promise&lt;<a href="#icontractsendreceipt">IContractSendReceipt</a>&gt;</td>
</tr>
<tr>
<td></td>
<td>交易收据, 带有事件日志.</td>
</tr>
</tbody></table>
<h1 id='qtumrpc'>QtumRPC</h1><pre class="highlight typescript"><code><span class="kd">const</span> <span class="nx">rpc</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">QtumRPC</span><span class="p">(</span><span class="s1">'http://qtum:test@localhost:3889'</span><span class="p">);</span>
</code></pre>
<p>这是一个用于直接访问 <code>qtumd</code> RPC API 的 JSON-RPC 客户端。它不会为你处理任何 ABI 编码或解码。</p>

<p>有需要的话你可以把 RPC 用户名和密码包含到 URL 里。在例子中，用户名是 <code>qtum</code> ，密码是 <code>test</code>.</p>

<p>QtumRPC类有一些在合约抽象内部使用的未公开的方法。 考虑将来可能会发生变化的任何未经证实的不受支持的内容。 现在，rawCall是唯一的公共API。
注意: <code>QtumRPC</code> 类有一些没文档的 public 方法在 <code>Contract</code> 抽象层内部使用到了. 你要考虑到之后可能不支持的无文档的内容. 现在 <code>rawCall</code> 是唯一发布的 API.</p>

<table><thead>
<tr>
<th>参数</th>
<th>类型</th>
</tr>
</thead><tbody>
<tr>
<td>url</td>
<td>string</td>
</tr>
<tr>
<td></td>
<td>qtumd RPC 服务的 URL</td>
</tr>
</tbody></table>
<h2 id='rawcall-2'>rawCall</h2>
<blockquote>
<p>调用 <code>getinfo</code> RPC 方法以获取 Qutm 区块链的基本信息：</p>
</blockquote>
<pre class="highlight typescript"><code><span class="kd">const</span> <span class="nx">info</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">rpc</span><span class="p">.</span><span class="nx">rawCall</span><span class="p">(</span><span class="s2">"getinfo"</span><span class="p">)</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">info</span><span class="p">)</span>
</code></pre>
<blockquote>
<p><code>getinfo</code> 的输出:</p>
</blockquote>
<pre class="highlight javascript"><code><span class="p">{</span> <span class="nl">version</span><span class="p">:</span> <span class="mi">141300</span><span class="p">,</span>
  <span class="nx">protocolversion</span><span class="p">:</span> <span class="mi">70016</span><span class="p">,</span>
  <span class="nx">walletversion</span><span class="p">:</span> <span class="mi">130000</span><span class="p">,</span>
  <span class="nx">balance</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="nx">stake</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="nx">blocks</span><span class="p">:</span> <span class="mi">85685</span><span class="p">,</span>
  <span class="nx">timeoffset</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="nx">connections</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
  <span class="nx">proxy</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span>
  <span class="nx">difficulty</span><span class="p">:</span>
   <span class="p">{</span> <span class="s1">'proof-of-work'</span><span class="p">:</span> <span class="mf">0.0000152587890625</span><span class="p">,</span>
     <span class="s1">'proof-of-stake'</span><span class="p">:</span> <span class="mf">5207642.8878753</span> <span class="p">},</span>
  <span class="nx">testnet</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
  <span class="nx">moneysupply</span><span class="p">:</span> <span class="mi">100322740</span><span class="p">,</span>
  <span class="nx">keypoololdest</span><span class="p">:</span> <span class="mi">1513325658</span><span class="p">,</span>
  <span class="nx">keypoolsize</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
  <span class="nx">paytxfee</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="nx">relayfee</span><span class="p">:</span> <span class="mf">0.004</span><span class="p">,</span>
  <span class="nx">errors</span><span class="p">:</span> <span class="s1">''</span> <span class="p">}</span>
</code></pre>
<p>发起一个 JSON-RPC 1.0 方法调用, 返回调用结果. 如果 JSON API 返回不是 200 HTTP 结果，则抛出错误。</p>

<blockquote>
<p>使用 <code>try...catch</code> 处理错误:</p>
</blockquote>
<pre class="highlight typescript"><code><span class="k">async</span> <span class="kd">function</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">rpc</span><span class="p">.</span><span class="nx">rawCall</span><span class="p">(</span><span class="s2">"unknown-method-hohoho"</span><span class="p">)</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"err"</span><span class="p">,</span> <span class="nx">err</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre><h2 id='all-rpc'>All RPC 方法</h2>
<p>qtumd 支持的所有 RPC 方法 .</p>
<pre class="highlight plaintext"><code>== Blockchain ==
callcontract "address" "data" ( address )
getaccountinfo "address"
getbestblockhash
getblock "blockhash" ( verbose )
getblockchaininfo
getblockcount
getblockhash height
getblockheader "hash" ( verbose )
getchaintips
getdifficulty
getmempoolancestors txid (verbose)
getmempooldescendants txid (verbose)
getmempoolentry txid
getmempoolinfo
getrawmempool ( verbose )
getstorage "address"
gettransactionreceipt "hash"
gettxout "txid" n ( include_mempool )
gettxoutproof ["txid",...] ( blockhash )
gettxoutsetinfo
listcontracts (start maxDisplay)
preciousblock "blockhash"
pruneblockchain
searchlogs &lt;fromBlock&gt; &lt;toBlock&gt; (address) (topics)
verifychain ( checklevel nblocks )
verifytxoutproof "proof"
waitforlogs (fromBlock) (toBlock) (filter) (minconf)

== Control ==
getinfo
getmemoryinfo
help ( "command" )
stop

== Generating ==
generate nblocks ( maxtries )
generatetoaddress nblocks address (maxtries)

== Mining ==
getblocktemplate ( TemplateRequest )
getmininginfo
getnetworkhashps ( nblocks height )
getstakinginfo
getsubsidy [nTarget]
prioritisetransaction &lt;txid&gt; &lt;priority delta&gt; &lt;fee delta&gt;
submitblock "hexdata" ( "jsonparametersobject" )

== Network ==
addnode "node" "add|remove|onetry"
clearbanned
disconnectnode "node"
getaddednodeinfo ( "node" )
getconnectioncount
getnettotals
getnetworkinfo
getpeerinfo
listbanned
ping
setban "subnet" "add|remove" (bantime) (absolute)
setnetworkactive true|false

== Rawtransactions ==
createrawtransaction [{"txid":"id","vout":n},...] {"address":amount,"data":"hex",...} ( locktime )
decoderawtransaction "hexstring"
decodescript "hexstring"
fromhexaddress "hexaddress"
fundrawtransaction "hexstring" ( options )
gethexaddress "address"
getrawtransaction "txid" ( verbose )
sendrawtransaction "hexstring" ( allowhighfees )
signrawtransaction "hexstring" ( [{"txid":"id","vout":n,"scriptPubKey":"hex","redeemScript":"hex"},...] ["privatekey1",...] sighashtype )

== Util ==
createmultisig nrequired ["key",...]
estimatefee nblocks
estimatepriority nblocks
estimatesmartfee nblocks
estimatesmartpriority nblocks
signmessagewithprivkey "privkey" "message"
validateaddress "address"
verifymessage "address" "signature" "message"

== Wallet ==
abandontransaction "txid"
addmultisigaddress nrequired ["key",...] ( "account" )
addwitnessaddress "address"
backupwallet "destination"
bumpfee "txid" ( options )
createcontract "bytecode" (gaslimit gasprice "senderaddress" broadcast)
dumpprivkey "address"
dumpwallet "filename"
encryptwallet "passphrase"
getaccount "address"
getaccountaddress "account"
getaddressesbyaccount "account"
getbalance ( "account" minconf include_watchonly )
getnewaddress ( "account" )
getrawchangeaddress
getreceivedbyaccount "account" ( minconf )
getreceivedbyaddress "address" ( minconf )
gettransaction "txid" ( include_watchonly ) (waitconf)
getunconfirmedbalance
getwalletinfo
importaddress "address" ( "label" rescan p2sh )
importmulti "requests" "options"
importprivkey "qtum" ( "label" ) ( rescan )
importprunedfunds
importpubkey "pubkey" ( "label" rescan )
importwallet "filename"
keypoolrefill ( newsize )
listaccounts ( minconf include_watchonly)
listaddressgroupings
listlockunspent
listreceivedbyaccount ( minconf include_empty include_watchonly)
listreceivedbyaddress ( minconf include_empty include_watchonly)
listsinceblock ( "blockhash" target_confirmations include_watchonly)
listtransactions ( "account" count skip include_watchonly)
listunspent ( minconf maxconf  ["addresses",...] [include_unsafe] )
lockunspent unlock ([{"txid":"txid","vout":n},...])
move "fromaccount" "toaccount" amount ( minconf "comment" )
removeprunedfunds "txid"
reservebalance [&lt;reserve&gt; [amount]]
sendfrom "fromaccount" "toaddress" amount ( minconf "comment" "comment_to" )
sendmany "fromaccount" {"address":amount,...} ( minconf "comment" ["address",...] )
sendmanywithdupes "fromaccount" {"address":amount,...} ( minconf "comment" ["address",...] )
sendtoaddress "address" amount ( "comment" "comment_to" subtractfeefromamount )
sendtocontract "contractaddress" "data" (amount gaslimit gasprice senderaddress broadcast)
setaccount "address" "account"
settxfee amount
signmessage "address" "message"
</code></pre><h2 id='getblockcount'>实例: getblockcount</h2>
<p>返回最长的区块链的块数。</p>
<pre class="highlight typescript"><code><span class="kd">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">rpc</span><span class="p">.</span><span class="nx">rawCall</span><span class="p">(</span><span class="s2">"getblockcount"</span><span class="p">)</span>
</code></pre>
<blockquote>
<p>结果</p>
</blockquote>
<pre class="highlight plaintext"><code>85687
</code></pre><h2 id='getnewaddress'>实例: getnewaddress</h2>
<p>返回接收付款的新 Qtum 地址。可能对要为用户生成存款地址的交易所有用。</p>
<pre class="highlight typescript"><code><span class="kd">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">rpc</span><span class="p">.</span><span class="nx">rawCall</span><span class="p">(</span><span class="s2">"getnewaddress"</span><span class="p">)</span>
</code></pre>
<blockquote>
<p>结果</p>
</blockquote>
<pre class="highlight plaintext"><code>QSnrDTj4UNcRwKdhY8sUZEd74VzwqeAddW
</code></pre><h2 id='fromhexaddress'>实例: fromhexaddress</h2>
<p>把一个 base58 pubkeyhash 地址转化成 16 进制地址用于智能合约。</p>
<pre class="highlight typescript"><code><span class="kd">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">rpc</span><span class="p">.</span><span class="nx">rawCall</span><span class="p">(</span><span class="s2">"gethexaddress"</span><span class="p">,</span> <span class="p">[</span><span class="s2">"QSnrDTj4UNcRwKdhY8sUZEd74VzwqeAddW"</span><span class="p">])</span>
</code></pre>
<blockquote>
<p>结果</p>
</blockquote>
<pre class="highlight plaintext"><code>43debdac95a0eaa4ff92d6b873944a4d92beae59
</code></pre><h2 id='gettransactionreceipt'>实例: gettransactionreceipt</h2>
<p>获得确认交易的收据。</p>
<pre class="highlight typescript"><code><span class="kd">const</span> <span class="nx">txid</span> <span class="o">=</span> <span class="s2">"62fecfd27d71ddb260ac48c73c8f0f87e96d0b3a598ed2c2251caa4e6f9a9d97"</span>
<span class="kd">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">rpc</span><span class="p">.</span><span class="nx">rawCall</span><span class="p">(</span><span class="s2">"gettransactionreceipt"</span><span class="p">,</span> <span class="p">[</span><span class="nx">txid</span><span class="p">])</span>
</code></pre>
<blockquote>
<p>结果</p>
</blockquote>
<pre class="highlight javascript"><code><span class="p">[</span>
  <span class="p">{</span>
    <span class="s2">"blockHash"</span><span class="p">:</span> <span class="s2">"af37cb8d9905521542243005fadc9f18c1498c9823e35fa277ea1c37174c289a"</span><span class="p">,</span>
    <span class="s2">"blockNumber"</span><span class="p">:</span> <span class="mi">83981</span><span class="p">,</span>
    <span class="s2">"transactionHash"</span><span class="p">:</span> <span class="s2">"62fecfd27d71ddb260ac48c73c8f0f87e96d0b3a598ed2c2251caa4e6f9a9d97"</span><span class="p">,</span>
    <span class="s2">"transactionIndex"</span><span class="p">:</span> <span class="mi">28</span><span class="p">,</span>
    <span class="s2">"from"</span><span class="p">:</span> <span class="s2">"57142e3bcf000f28890b5d979afc7ea90204e1de"</span><span class="p">,</span>
    <span class="s2">"to"</span><span class="p">:</span> <span class="s2">"49665919e437a4bedb92faa45ed33ebb5a33ee63"</span><span class="p">,</span>
    <span class="s2">"cumulativeGasUsed"</span><span class="p">:</span> <span class="mi">37029</span><span class="p">,</span>
    <span class="s2">"gasUsed"</span><span class="p">:</span> <span class="mi">37029</span><span class="p">,</span>
    <span class="s2">"contractAddress"</span><span class="p">:</span> <span class="s2">"49665919e437a4bedb92faa45ed33ebb5a33ee63"</span><span class="p">,</span>
    <span class="s2">"log"</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="s2">"address"</span><span class="p">:</span> <span class="s2">"49665919e437a4bedb92faa45ed33ebb5a33ee63"</span><span class="p">,</span>
        <span class="s2">"topics"</span><span class="p">:</span> <span class="p">[</span>
          <span class="s2">"ddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"</span><span class="p">,</span>
          <span class="s2">"00000000000000000000000057142e3bcf000f28890b5d979afc7ea90204e1de"</span><span class="p">,</span>
          <span class="s2">"000000000000000000000000c0ed80283c53c300c31c2bda6eca841e53cb6a21"</span>
        <span class="p">],</span>
        <span class="s2">"data"</span><span class="p">:</span> <span class="s2">"000000000000000000000000000000000000000000000000000001ba5add5700"</span>
      <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">}</span>
<span class="p">]</span>
</code></pre><h1 id='-4'>类型词典</h1><h2 id='icontractinfo'>IContractInfo</h2><pre class="highlight typescript"><code><span class="k">export</span> <span class="kr">interface</span> <span class="nx">IContractInfo</span> <span class="p">{</span>
  <span class="cm">/**
   * 合约的 ABI 定义, solc 生成.
   */</span>
  <span class="nl">abi</span><span class="p">:</span> <span class="nx">IABIMethod</span><span class="p">[]</span>

  <span class="cm">/**
   * 合约地址
   */</span>
  <span class="nl">address</span><span class="p">:</span> <span class="kr">string</span>

  <span class="cm">/**
   * 合约所有者的地址
   */</span>
  <span class="nx">sender</span><span class="p">?:</span> <span class="kr">string</span>
<span class="p">}</span>
</code></pre>
<p>与部署合约交互所需的最少部署信息。</p>
<h2 id='icontractcallresult'>IContractCallResult</h2>
<p>调用一个合约方法的返回结果，带有解码的输出和日志。</p>
<pre class="highlight typescript"><code><span class="k">export</span> <span class="kr">interface</span> <span class="nx">IContractCallResult</span> <span class="k">extends</span> <span class="nx">IRPCCallContractResult</span> <span class="p">{</span>
  <span class="cm">/**
   * ABI 解码的输出
   */</span>
  <span class="nl">outputs</span><span class="p">:</span> <span class="kr">any</span><span class="p">[]</span>

  <span class="cm">/**
   * ABI 解码的日志
   */</span>
  <span class="nl">logs</span><span class="p">:</span> <span class="nb">Array</span><span class="o">&lt;</span><span class="nx">IDecodedSolidityEvent</span> <span class="o">|</span> <span class="kc">null</span><span class="o">&gt;</span>
<span class="p">}</span>

<span class="k">export</span> <span class="kr">interface</span> <span class="nx">IRPCCallContractResult</span> <span class="p">{</span>
  <span class="nl">address</span><span class="p">:</span> <span class="kr">string</span>
  <span class="nl">executionResult</span><span class="p">:</span> <span class="nx">IExecutionResult</span><span class="p">,</span>
  <span class="nx">transactionReceipt</span><span class="p">:</span> <span class="p">{</span>
    <span class="nl">stateRoot</span><span class="p">:</span> <span class="kr">string</span><span class="p">,</span>
    <span class="nx">gasUsed</span><span class="p">:</span> <span class="kr">string</span><span class="p">,</span>
    <span class="nx">bloom</span><span class="p">:</span> <span class="kr">string</span><span class="p">,</span>
    <span class="nx">log</span><span class="p">:</span> <span class="kr">any</span><span class="p">[],</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="k">export</span> <span class="kr">interface</span> <span class="nx">IExecutionResult</span> <span class="p">{</span>
  <span class="nl">gasUsed</span><span class="p">:</span> <span class="kr">number</span><span class="p">,</span>
  <span class="nx">excepted</span><span class="p">:</span> <span class="kr">string</span><span class="p">,</span>
  <span class="nx">newAddress</span><span class="p">:</span> <span class="kr">string</span><span class="p">,</span>
  <span class="nx">output</span><span class="p">:</span> <span class="kr">string</span><span class="p">,</span>
  <span class="nx">codeDeposit</span><span class="p">:</span> <span class="kr">number</span><span class="p">,</span>
  <span class="nx">gasRefunded</span><span class="p">:</span> <span class="kr">number</span><span class="p">,</span>
  <span class="nx">depositSize</span><span class="p">:</span> <span class="kr">number</span><span class="p">,</span>
  <span class="nx">gasForDeposit</span><span class="p">:</span> <span class="kr">number</span><span class="p">,</span>
<span class="p">}</span>
</code></pre>
<blockquote>
<p>实例:</p>
</blockquote>
<pre class="highlight javascript"><code><span class="p">{</span>
  <span class="s2">"address"</span><span class="p">:</span> <span class="s2">"a778c05f1d0f70f1133f4bbf78c1a9a7bf84aed3"</span><span class="p">,</span>
  <span class="s2">"executionResult"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"gasUsed"</span><span class="p">:</span> <span class="mi">39306</span><span class="p">,</span>
    <span class="s2">"excepted"</span><span class="p">:</span> <span class="s2">"None"</span><span class="p">,</span>
    <span class="s2">"newAddress"</span><span class="p">:</span> <span class="s2">"a778c05f1d0f70f1133f4bbf78c1a9a7bf84aed3"</span><span class="p">,</span>
    <span class="s2">"output"</span><span class="p">:</span> <span class="s2">"0000000000000000000000000000000000000000000000000000000000000001"</span><span class="p">,</span>
    <span class="s2">"codeDeposit"</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s2">"gasRefunded"</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s2">"depositSize"</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s2">"gasForDeposit"</span><span class="p">:</span> <span class="mi">0</span>
  <span class="p">},</span>
  <span class="s2">"transactionReceipt"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"stateRoot"</span><span class="p">:</span> <span class="s2">"9922edb770bd700a212427d3bc0764a9fed953a987952b2619b8a78dac7498aa"</span><span class="p">,</span>
    <span class="s2">"gasUsed"</span><span class="p">:</span> <span class="mi">39306</span><span class="p">,</span>
    <span class="s2">"bloom"</span><span class="p">:</span> <span class="s2">"00000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000020000000000008000000000000000000000000000000000000000000000000020000000020000000000800000000000000400000000010000000000000000000000000000000000000000000000000000000000000000000000000000080000000080000000000000000000000000000000000000000000000000000000002010000000000000000000000000000000200000000000000000020000000000000000000000000000000000000000000000000020000000000000000"</span><span class="p">,</span>
    <span class="s2">"log"</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="s2">"address"</span><span class="p">:</span> <span class="s2">"a778c05f1d0f70f1133f4bbf78c1a9a7bf84aed3"</span><span class="p">,</span>
        <span class="s2">"topics"</span><span class="p">:</span> <span class="p">[</span>
          <span class="s2">"0f6798a560793a54c3bcfe86a93cde1e73087d944c0ea20544137d4121396885"</span><span class="p">,</span>
          <span class="s2">"000000000000000000000000dcd32b87270aeb980333213da2549c9907e09e94"</span>
        <span class="p">],</span>
        <span class="s2">"data"</span><span class="p">:</span> <span class="s2">"00000000000000000000000000000000000000000000000000000000000003e8"</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="s2">"address"</span><span class="p">:</span> <span class="s2">"a778c05f1d0f70f1133f4bbf78c1a9a7bf84aed3"</span><span class="p">,</span>
        <span class="s2">"topics"</span><span class="p">:</span> <span class="p">[</span>
          <span class="s2">"ddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"</span><span class="p">,</span>
          <span class="s2">"0000000000000000000000000000000000000000000000000000000000000000"</span><span class="p">,</span>
          <span class="s2">"000000000000000000000000dcd32b87270aeb980333213da2549c9907e09e94"</span>
        <span class="p">],</span>
        <span class="s2">"data"</span><span class="p">:</span> <span class="s2">"00000000000000000000000000000000000000000000000000000000000003e8"</span>
      <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">},</span>
  <span class="s2">"outputs"</span><span class="p">:</span> <span class="p">[</span>
    <span class="kc">true</span>
  <span class="p">],</span>
  <span class="s2">"logs"</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"Mint"</span><span class="p">,</span>
      <span class="s2">"to"</span><span class="p">:</span> <span class="s2">"dcd32b87270aeb980333213da2549c9907e09e94"</span><span class="p">,</span>
      <span class="s2">"amount"</span><span class="p">:</span> <span class="s2">"3e8"</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"Transfer"</span><span class="p">,</span>
      <span class="s2">"from"</span><span class="p">:</span> <span class="s2">"0000000000000000000000000000000000000000"</span><span class="p">,</span>
      <span class="s2">"to"</span><span class="p">:</span> <span class="s2">"dcd32b87270aeb980333213da2549c9907e09e94"</span><span class="p">,</span>
      <span class="s2">"value"</span><span class="p">:</span> <span class="s2">"3e8"</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</code></pre>
<p><code>Contract#call</code> 的返回类型.</p>
<h2 id='icontractsendrequestoptions'>IContractSendRequestOptions</h2>
<p><a href="#send">Contract#send</a> 的配置项</p>
<pre class="highlight typescript"><code><span class="cm">/**
 * `send` 合约方法的配置项.
 */</span>
<span class="k">export</span> <span class="kr">interface</span> <span class="nx">IContractSendRequestOptions</span> <span class="p">{</span>
  <span class="cm">/**
   * 要发送的 QTUM 数. 例如 0.1, 默认: 0
   */</span>
  <span class="nx">amount</span><span class="p">?:</span> <span class="kr">number</span> <span class="o">|</span> <span class="kr">string</span>

  <span class="cm">/**
   * gasLimit, 默认: 200000, 最大: 40000000
   */</span>
  <span class="nx">gasLimit</span><span class="p">?:</span> <span class="kr">number</span>

  <span class="cm">/**
   * 每 gas 的 Qtum 价格, 默认: 0.00000001, 最小:0.00000001
   */</span>
  <span class="nx">gasPrice</span><span class="p">?:</span> <span class="kr">number</span> <span class="o">|</span> <span class="kr">string</span>

  <span class="cm">/**
   * 发送者的 quantum 地址
   */</span>
  <span class="nx">senderAddress</span><span class="p">?:</span> <span class="kr">string</span>
<span class="p">}</span>
</code></pre><h2 id='icontractsendresult'>IContractSendResult</h2><pre class="highlight typescript"><code><span class="kd">const</span> <span class="nx">tx</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">method</span><span class="p">,</span> <span class="nx">args</span><span class="p">)</span>
<span class="k">await</span> <span class="nx">tx</span><span class="p">.</span><span class="nx">confirm</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="p">(</span><span class="nx">updatedTx</span><span class="p">,</span> <span class="nx">receipt</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="c1">/// ...</span>
<span class="p">})</span>
</code></pre>
<p>返回 <a href="#send">Contract#send</a> 的值。</p>

<p><code>confirm</code> 方法用来等待交易确认。</p>

<p><code>confirm</code> 方法的参数:</p>

<table><thead>
<tr>
<th>参数</th>
<th>类型</th>
</tr>
</thead><tbody>
<tr>
<td>n</td>
<td>number</td>
</tr>
<tr>
<td></td>
<td><em>可选</em> 须等待的确认数</td>
</tr>
<tr>
<td>callback</td>
<td>IContractSendConfirmationHandler</td>
</tr>
<tr>
<td></td>
<td><em>可选</em> 回调函数，每次确认都会调用</td>
</tr>
</tbody></table>

<p>回调值为:</p>

<table><thead>
<tr>
<th>参数</th>
<th>类型</th>
</tr>
</thead><tbody>
<tr>
<td>updatedTx</td>
<td>IRPCGetTransactionResult</td>
</tr>
<tr>
<td></td>
<td>关于提交给网络的交易的基本信息</td>
</tr>
<tr>
<td>receipt</td>
<td>IContractSendReceipt</td>
</tr>
<tr>
<td></td>
<td>关于已确认交易的其他信息</td>
</tr>
</tbody></table>
<h3 id='-5'>参考</h3>
<ul>
<li><a href="#irpcgettransactionresult">IRPCGetTransactionResult</a></li>
<li><a href="#icontractsendreceipt">IContractSendReceipt</a></li>
</ul>
<h2 id='irpcgettransactionresult'>IRPCGetTransactionResult</h2><pre class="highlight typescript"><code><span class="k">export</span> <span class="kr">interface</span> <span class="nx">IRPCGetTransactionResult</span> <span class="p">{</span>
  <span class="nl">amount</span><span class="p">:</span> <span class="kr">number</span><span class="p">,</span>
  <span class="nx">fee</span><span class="p">:</span> <span class="kr">number</span><span class="p">,</span>
  <span class="nx">confirmations</span><span class="p">:</span> <span class="kr">number</span><span class="p">,</span>
  <span class="nx">blockhash</span><span class="p">:</span> <span class="kr">string</span><span class="p">,</span>
  <span class="nx">blockindex</span><span class="p">:</span> <span class="kr">number</span><span class="p">,</span>
  <span class="nx">blocktime</span><span class="p">:</span> <span class="kr">number</span><span class="p">,</span>
  <span class="nx">txid</span><span class="p">:</span> <span class="kr">string</span><span class="p">,</span>
  <span class="nx">walletconflicts</span><span class="p">:</span> <span class="kr">any</span><span class="p">[],</span>
  <span class="nx">time</span><span class="p">:</span> <span class="kr">number</span><span class="p">,</span>
  <span class="nx">timereceived</span><span class="p">:</span> <span class="kr">number</span><span class="p">,</span>
  <span class="s2">"bip125-replaceable"</span><span class="p">:</span> <span class="s2">"no"</span> <span class="o">|</span> <span class="s2">"yes"</span> <span class="o">|</span> <span class="s2">"unknown"</span><span class="p">,</span>
  <span class="nx">details</span><span class="p">:</span> <span class="kr">any</span><span class="p">[]</span>
  <span class="nl">hex</span><span class="p">:</span> <span class="kr">string</span><span class="p">,</span>
<span class="p">}</span>
</code></pre>
<p>关于提交给网络的交易的基本信息。</p>
<h2 id='icontractsendreceipt'>IContractSendReceipt</h2>
<p><a href="#send">Contract#send</a> 的合约收据, 带有解码的事件日志</p>
<pre class="highlight typescript"><code><span class="k">export</span> <span class="kr">interface</span> <span class="nx">IContractSendReceipt</span> <span class="k">extends</span> <span class="nx">IRPCGetTransactionReceiptBase</span> <span class="p">{</span>
  <span class="cm">/**
   * 使用 ABI 解码的日志
   */</span>
  <span class="nl">logs</span><span class="p">:</span> <span class="nx">IDecodedLog</span><span class="p">[],</span>

  <span class="cm">/**
   * 未解码的日志
   */</span>
  <span class="nx">rawlogs</span><span class="p">:</span> <span class="nx">ITransactionLog</span><span class="p">[],</span>
<span class="p">}</span>

<span class="cm">/**
 * 解码的 Solidity 事件日志
 */</span>
<span class="k">export</span> <span class="kr">interface</span> <span class="nx">IDecodedLog</span> <span class="p">{</span>
  <span class="cm">/**
   * 事件日志名称
   */</span>
  <span class="nl">type</span><span class="p">:</span> <span class="kr">string</span>

  <span class="cm">/**
   * 键值映射作为事件日志参数
   */</span>
  <span class="p">[</span><span class="nx">key</span><span class="p">:</span> <span class="kr">string</span><span class="p">]:</span> <span class="kr">any</span>
<span class="p">}</span>
</code></pre>
<blockquote>
<p>实例</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"blockHash"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3b53ad132c26f9c30e5be9f664573428dad8b52e167becea4428d6903cb32740"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"blockNumber"</span><span class="p">:</span><span class="w"> </span><span class="mi">13917</span><span class="p">,</span><span class="w">
  </span><span class="s2">"transactionHash"</span><span class="p">:</span><span class="w"> </span><span class="s2">"79338589bb75e1865be889142890a4e25d3b9dbd454ce3f3c2614587c85e2ed3"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"transactionIndex"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="s2">"from"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dcd32b87270aeb980333213da2549c9907e09e94"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"to"</span><span class="p">:</span><span class="w"> </span><span class="s2">"a778c05f1d0f70f1133f4bbf78c1a9a7bf84aed3"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"cumulativeGasUsed"</span><span class="p">:</span><span class="w"> </span><span class="mi">39306</span><span class="p">,</span><span class="w">
  </span><span class="s2">"gasUsed"</span><span class="p">:</span><span class="w"> </span><span class="mi">39306</span><span class="p">,</span><span class="w">
  </span><span class="s2">"contractAddress"</span><span class="p">:</span><span class="w"> </span><span class="s2">"a778c05f1d0f70f1133f4bbf78c1a9a7bf84aed3"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"logs"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Mint"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"to"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dcd32b87270aeb980333213da2549c9907e09e94"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"amount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"7d0"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Transfer"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"from"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0000000000000000000000000000000000000000"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"to"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dcd32b87270aeb980333213da2549c9907e09e94"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"7d0"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="s2">"rawlogs"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"address"</span><span class="p">:</span><span class="w"> </span><span class="s2">"a778c05f1d0f70f1133f4bbf78c1a9a7bf84aed3"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"topics"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"0f6798a560793a54c3bcfe86a93cde1e73087d944c0ea20544137d4121396885"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"000000000000000000000000dcd32b87270aeb980333213da2549c9907e09e94"</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="s2">"00000000000000000000000000000000000000000000000000000000000007d0"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"address"</span><span class="p">:</span><span class="w"> </span><span class="s2">"a778c05f1d0f70f1133f4bbf78c1a9a7bf84aed3"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"topics"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"ddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"0000000000000000000000000000000000000000000000000000000000000000"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"000000000000000000000000dcd32b87270aeb980333213da2549c9907e09e94"</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="s2">"00000000000000000000000000000000000000000000000000000000000007d0"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><h3 id='-6'>参考</h3>
<ul>
<li><a href="#irpcgettransactionreceiptbase">IRPCGetTransactionReceiptBase</a></li>
</ul>
<h2 id='irpcwaitforlogsrequest'>IRPCWaitForLogsRequest</h2><pre class="highlight typescript"><code><span class="k">export</span> <span class="kr">interface</span> <span class="nx">IRPCWaitForLogsRequest</span> <span class="p">{</span>
  <span class="cm">/**
   * 查找日志的开始块号。
   */</span>
  <span class="nx">fromBlock</span><span class="p">?:</span> <span class="kr">number</span> <span class="o">|</span> <span class="s2">"latest"</span><span class="p">,</span>

  <span class="cm">/**
   * 查找日志的停止块号. 如果是 null, 会无限期等待
   */</span>
  <span class="nx">toBlock</span><span class="p">?:</span> <span class="kr">number</span> <span class="o">|</span> <span class="s2">"latest"</span><span class="p">,</span>

  <span class="cm">/**
   * 过滤日志的条件。 地址和主题分别指定为十六进制字符串数组
   */</span>
  <span class="nx">filter</span><span class="p">?:</span> <span class="nx">ILogFilter</span><span class="p">,</span>

  <span class="cm">/**
   * 日志返回前的最少确认数
   */</span>
  <span class="nx">minconf</span><span class="p">?:</span> <span class="kr">number</span><span class="p">,</span>
<span class="p">}</span>
</code></pre><h2 id='icontracteventlogs'>IContractEventLogs</h2><pre class="highlight typescript"><code><span class="cm">/**
 * 查询合约事件日志的结果。
 */</span>
<span class="k">export</span> <span class="kr">interface</span> <span class="nx">IContractEventLogs</span> <span class="p">{</span>
  <span class="cm">/**
   * 事件日志, ABI 解码.
   */</span>
  <span class="nl">entries</span><span class="p">:</span> <span class="nx">IContractEventLog</span><span class="p">[]</span>

  <span class="cm">/**
   * 返回的事件日志数
   */</span>
  <span class="nl">count</span><span class="p">:</span> <span class="kr">number</span>

  <span class="cm">/**
   * 要开始查询新事件日志的块号
   */</span>
  <span class="nl">nextblock</span><span class="p">:</span> <span class="kr">number</span>
<span class="p">}</span>
</code></pre>
<p>查询合约事件日志的结果。</p>

<p>要查询尚未出现的新日志，请在查询事件日志时将 <code>nextblock</code> 用作 <code>startBlock</code>：
* <a href="#icontracteventlog">IContractEventLog</a></p>
<h2 id='icontracteventlog'>IContractEventLog</h2>
<p>一条解码的合约事件日志</p>
<pre class="highlight typescript"><code><span class="k">export</span> <span class="kr">interface</span> <span class="nx">IContractLogEntry</span> <span class="k">extends</span> <span class="nx">ILogEntry</span> <span class="p">{</span>
  <span class="cm">/**
   * Solidity 事件, ABI 解码. 如果没有找到 ABI 定义，为 Null
   */</span>
  <span class="nx">event</span><span class="p">?:</span> <span class="nx">ISolidityEvent</span>
<span class="p">}</span>

<span class="cm">/**
 *  qtumd 返回的原始日志数据，不是 ABI 解码
 */</span>
<span class="k">export</span> <span class="kr">interface</span> <span class="nx">ILogEntry</span> <span class="k">extends</span> <span class="nx">IRPCGetTransactionReceiptBase</span> <span class="p">{</span>
  <span class="cm">/**
   * EVM 日志主题
   */</span>
  <span class="nl">topics</span><span class="p">:</span> <span class="kr">string</span><span class="p">[]</span>

  <span class="cm">/**
   * EVM 日志数据, 十六进制字符串
   */</span>
  <span class="nl">data</span><span class="p">:</span> <span class="kr">string</span>
<span class="p">}</span>

<span class="cm">/**
 * qtumd 返回的交易收据
 */</span>
<span class="k">export</span> <span class="kr">interface</span> <span class="nx">IRPCGetTransactionReceiptBase</span> <span class="p">{</span>
  <span class="nl">blockHash</span><span class="p">:</span> <span class="kr">string</span>
  <span class="nl">blockNumber</span><span class="p">:</span> <span class="kr">number</span>

  <span class="nl">transactionHash</span><span class="p">:</span> <span class="kr">string</span>
  <span class="nl">transactionIndex</span><span class="p">:</span> <span class="kr">number</span>

  <span class="nl">from</span><span class="p">:</span> <span class="kr">string</span>
  <span class="nl">to</span><span class="p">:</span> <span class="kr">string</span>

  <span class="nl">cumulativeGasUsed</span><span class="p">:</span> <span class="kr">number</span>
  <span class="nl">gasUsed</span><span class="p">:</span> <span class="kr">number</span>

  <span class="nl">contractAddress</span><span class="p">:</span> <span class="kr">string</span>
<span class="p">}</span>
</code></pre>
<blockquote>
<p>实例</p>
</blockquote>
<pre class="highlight javascript"><code><span class="p">{</span>
  <span class="s2">"blockHash"</span><span class="p">:</span> <span class="s2">"369c6ded05c27ae7efc97964cce083b0ea9b8b950e67c51e52cb1bf898b9c415"</span><span class="p">,</span>
  <span class="s2">"blockNumber"</span><span class="p">:</span> <span class="mi">12184</span><span class="p">,</span>
  <span class="s2">"transactionHash"</span><span class="p">:</span> <span class="s2">"d1638a53f38fd68c5763e2eef9d86b9fc6ee7ea3f018dae7b1e385b4a9a78bc7"</span><span class="p">,</span>
  <span class="s2">"transactionIndex"</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
  <span class="s2">"from"</span><span class="p">:</span> <span class="s2">"dcd32b87270aeb980333213da2549c9907e09e94"</span><span class="p">,</span>
  <span class="s2">"to"</span><span class="p">:</span> <span class="s2">"a778c05f1d0f70f1133f4bbf78c1a9a7bf84aed3"</span><span class="p">,</span>
  <span class="s2">"cumulativeGasUsed"</span><span class="p">:</span> <span class="mi">39306</span><span class="p">,</span>
  <span class="s2">"gasUsed"</span><span class="p">:</span> <span class="mi">39306</span><span class="p">,</span>
  <span class="s2">"contractAddress"</span><span class="p">:</span> <span class="s2">"a778c05f1d0f70f1133f4bbf78c1a9a7bf84aed3"</span><span class="p">,</span>
  <span class="s2">"topics"</span><span class="p">:</span> <span class="p">[</span>
    <span class="s2">"0f6798a560793a54c3bcfe86a93cde1e73087d944c0ea20544137d4121396885"</span><span class="p">,</span>
    <span class="s2">"000000000000000000000000dcd32b87270aeb980333213da2549c9907e09e94"</span>
  <span class="p">],</span>
  <span class="s2">"data"</span><span class="p">:</span> <span class="s2">"00000000000000000000000000000000000000000000000000000000000003e8"</span><span class="p">,</span>
  <span class="s2">"event"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"Mint"</span><span class="p">,</span>
    <span class="s2">"to"</span><span class="p">:</span> <span class="s2">"dcd32b87270aeb980333213da2549c9907e09e94"</span><span class="p">,</span>
    <span class="s2">"amount"</span><span class="p">:</span> <span class="s2">"3e8"</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre><h2 id='idecodedsolidityevent'>IDecodedSolidityEvent</h2><pre class="highlight typescript"><code><span class="cm">/**
 * 一个解码的 Solidity 事件日志
 */</span>
<span class="k">export</span> <span class="kr">interface</span> <span class="nx">IDecodedSolidityEvent</span> <span class="p">{</span>
  <span class="cm">/**
   * 事件名称
   */</span>
  <span class="nl">type</span><span class="p">:</span> <span class="kr">string</span>

  <span class="cm">/**
   * 键值映射作为事件日志参数
   */</span>
  <span class="p">[</span><span class="nx">key</span><span class="p">:</span> <span class="kr">string</span><span class="p">]:</span> <span class="kr">any</span>
<span class="p">}</span>
</code></pre>
<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight javascript"><code><span class="p">{</span>
  <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"Transfer"</span><span class="p">,</span>
  <span class="s2">"from"</span><span class="p">:</span> <span class="s2">"0000000000000000000000000000000000000000"</span><span class="p">,</span>
  <span class="s2">"to"</span><span class="p">:</span> <span class="s2">"dcd32b87270aeb980333213da2549c9907e09e94"</span><span class="p">,</span>
  <span class="s2">"value"</span><span class="p">:</span> <span class="s2">"3e8"</span>
<span class="p">}</span>
</code></pre>
<p>解码的 Solidity 事件日志。 事件参数存储在键值映射中。</p>
<h2 id='irpcgettransactionreceiptbase'>IRPCGetTransactionReceiptBase</h2>
<p>网络接受的交易收据。它由 <code>gettransactionreceipt</code> RPC 调用返回。</p>
<pre class="highlight typescript"><code><span class="k">export</span> <span class="kr">interface</span> <span class="nx">IRPCGetTransactionReceiptBase</span> <span class="p">{</span>
  <span class="nl">blockHash</span><span class="p">:</span> <span class="kr">string</span>
  <span class="nl">blockNumber</span><span class="p">:</span> <span class="kr">number</span>

  <span class="nl">transactionHash</span><span class="p">:</span> <span class="kr">string</span>
  <span class="nl">transactionIndex</span><span class="p">:</span> <span class="kr">number</span>

  <span class="nl">from</span><span class="p">:</span> <span class="kr">string</span>
  <span class="nl">to</span><span class="p">:</span> <span class="kr">string</span>

  <span class="nl">cumulativeGasUsed</span><span class="p">:</span> <span class="kr">number</span>
  <span class="nl">gasUsed</span><span class="p">:</span> <span class="kr">number</span>

  <span class="nl">contractAddress</span><span class="p">:</span> <span class="kr">string</span>
<span class="p">}</span>
</code></pre><h2 id='icontractsrepodata'>IContractsRepoData</h2>
<p>合约相关信息</p>
<pre class="highlight typescript"><code><span class="k">export</span> <span class="kr">interface</span> <span class="nx">IContractsRepoData</span> <span class="p">{</span>
  <span class="cm">/**
   * 部署合约的相关信息
   */</span>
  <span class="nl">contracts</span><span class="p">:</span> <span class="p">{</span>
    <span class="p">[</span><span class="nx">key</span><span class="p">:</span> <span class="kr">string</span><span class="p">]:</span> <span class="nx">IContractInfo</span><span class="p">,</span>
  <span class="p">},</span>

  <span class="cm">/**
   * 部署库的相关信息
   */</span>
  <span class="nx">libraries</span><span class="p">:</span> <span class="p">{</span>
    <span class="p">[</span><span class="nx">key</span><span class="p">:</span> <span class="kr">string</span><span class="p">]:</span> <span class="nx">IContractInfo</span><span class="p">,</span>
  <span class="p">}</span>

  <span class="cm">/**
   * 部署合约/库引用的合约信息，但未部署
   */</span>
  <span class="nl">related</span><span class="p">:</span> <span class="p">{</span>
    <span class="p">[</span><span class="nx">key</span><span class="p">:</span> <span class="kr">string</span><span class="p">]:</span> <span class="p">{</span>
      <span class="nl">abi</span><span class="p">:</span> <span class="nx">IABIMethod</span><span class="p">[],</span>
    <span class="p">},</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="cm">/**
 * 与部署合约进行交互所需的最少部署信息。
 */</span>
<span class="k">export</span> <span class="kr">interface</span> <span class="nx">IContractInfo</span> <span class="p">{</span>
  <span class="cm">/**
   * 合约的 ABI 定义, solc 生成.
   */</span>
  <span class="nl">abi</span><span class="p">:</span> <span class="nx">IABIMethod</span><span class="p">[]</span>

  <span class="cm">/**
   * 合约地址
   */</span>
  <span class="nl">address</span><span class="p">:</span> <span class="kr">string</span>

  <span class="cm">/**
   * 合约所有者的地址
   */</span>
  <span class="nx">sender</span><span class="p">?:</span> <span class="kr">string</span>
<span class="p">}</span>

<span class="k">export</span> <span class="kr">interface</span> <span class="nx">IABIMethod</span> <span class="p">{</span>
  <span class="nl">name</span><span class="p">:</span> <span class="kr">string</span><span class="p">,</span>
  <span class="kd">type</span><span class="p">:</span> <span class="kr">string</span><span class="p">,</span>
  <span class="nx">payable</span><span class="p">:</span> <span class="kr">boolean</span><span class="p">,</span>
  <span class="nx">inputs</span><span class="p">:</span> <span class="nx">IABIInput</span><span class="p">[],</span>
  <span class="nx">outputs</span><span class="p">:</span> <span class="nx">IABIOutput</span><span class="p">[],</span>
  <span class="nx">constant</span><span class="p">:</span> <span class="kr">boolean</span><span class="p">,</span>
  <span class="nx">anonymous</span><span class="p">:</span> <span class="kr">boolean</span><span class="p">,</span>
<span class="p">}</span>
</code></pre>
<p>可以使用开发工具 <a href="https://github.com/qtumproject/solar">solar</a> 自动生成。</p>

<p>样例 <a href="https://github.com/qtumproject/qtumbook-mytoken-qtumjs-cli/blob/29fab6dfcca55013c7efa8ee5e91bbc8c40ca55a/solar.development.json.example">solar.json</a>.</p>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="typescript">typescript</a>
                <a href="#" data-language-name="javascript">javascript</a>
          </div>
      </div>
    </div>
  </body>
</html>
